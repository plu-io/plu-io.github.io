<!DOCTYPE html>

<html lang="en">

<head>

  <title>LIY Body Type Calculator</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
    <link href="https://fonts.googleapis.com/css?family=Karla" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Muli" rel="stylesheet">
    <link href="assets/css/style.css" rel="stylesheet" type="text/css">

</head>

<body>

  <div class="page">
    <div class="section bust">
      <div>
        <h2>BUST</h2>
      </div>
      <input type="text" placeholder="inches"  pattern="[0-9]*" id="InputBust" required="true" />
    </div>
    <div class="section waist">
      <div>
        <h2>WAIST</h2>
      </div>
      <input type="text" placeholder="inches" pattern="[0-9]*" id="InputWaist" required="true" />
    </div>
    <div class="section hips">
      <div>
        <h2>HIPS</h2>
      </div>
      <input type="text" placeholder="inches"  pattern="[0-9]*" id="InputHips" required="true" />
    </div>
    <div class="section errorPar" id="measureErrorDiv">

    </div>
    <div class="section email">
      <div>
        <h2>EMAIL</h2>
      </div>
      <input type="email" placeholder="hello@livinginyellow.com" id="InputEmail" autocomplete="email" required="true" />
    </div>
    <div class="section errorPar" id="emailErrorDiv">

    </div>
    <div class="section subCheckbox">
      <input type="checkbox" id="SubscribeCheck" name="SubscribeCheck" checked>
      <p>Subscribe?</p>
    </div>
    <div class="section button">
      <input type="button" value="CALCULATE RESULTS" id="ResButton" />
    </div>
  </div>

</body>

<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '5575717';
  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = 'https://tag.getdrip.com/5575717.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip -->

<script type="text/javascript">
  var bodyType   = null,
      dripBody   = null,
      bustVal    = null,
      waistVal   = null,
      hipsVal    = null,
      subVal     = null,
      notBody    = [],
      InputBust  = document.getElementById("InputBust"),
      InputWaist = document.getElementById("InputWaist"),
      InputHips  = document.getElementById("InputHips"),
      MeasureErr = document.getElementById("measureErrorDiv"),
      InputEmail = document.getElementById("InputEmail"),
      EmailErr   = document.getElementById("emailErrorDiv"),
      InputSub   = document.getElementById("SubscribeCheck"),
      ResButton  = document.getElementById("ResButton");

  InputBust.addEventListener("blur", checkDatValidity);
  InputWaist.addEventListener("blur", checkDatValidity);
  InputHips.addEventListener("blur", checkDatValidity);
  InputEmail.addEventListener("blur", checkDatValidity);

  function checkDatValidity() {
    if (InputBust.value.substr(InputBust.value.length - 7, 7) == ' inches') {
      InputBust.value = InputBust.value.substr(0, InputBust.value.length - 7);
    }
    if (InputBust.value.substr(InputBust.value.length - 6, 6) == 'inches') {
      InputBust.value = InputBust.value.substr(0, InputBust.value.length - 6);
    }
    if (InputBust.value.substr(InputBust.value.length - 5, 5) == ' inch') {
      InputBust.value = InputBust.value.substr(0, InputBust.value.length - 5);
    }
    if (InputBust.value.substr(InputBust.value.length - 4, 4) == 'inch') {
      InputBust.value = InputBust.value.substr(0, InputBust.value.length - 4);
    }
    if (InputBust.value.substr(InputBust.value.length - 2, 2) == ' "' || InputBust.value.substr(InputBust.value.length - 2, 2) == ' in') {
      InputBust.value = InputBust.value.substr(0, InputBust.value.length - 2);
    }
    if (InputBust.value.substr(InputBust.value.length - 1, 1) == '"'  || InputBust.value.substr(InputBust.value.length - 1, 1) == 'in') {
      InputBust.value = InputBust.value.substr(0, InputBust.value.length - 1);
    }

    if (!InputBust.validity.valid || !InputWaist.validity.valid || !InputHips.validity.valid) {
      MeasureErr.innerHTML = "<p class='errorText'>Please check your measurements. They should be numbers.</p>";
    } else {
      MeasureErr.innerHTML = "";
    }
    if (!InputEmail.validity.valid) {
      EmailErr.innerHTML = "<p class='errorText'>Please enter a valid email.</p>";
    } else {
      EmailErr.innerHTML = "";
    }
  }

  ResButton.addEventListener("click", getResults);
  function getResults() {
    bustVal  = parseFloat(InputBust.value);
    waistVal = parseFloat(InputWaist.value);
    hipsVal  = parseFloat(InputHips.value);
    subVal   = InputSub.checked;
    if (InputBust.validity.valid && InputWaist.validity.valid && InputHips.validity.valid && InputEmail.validity.valid &&
        bustVal > 0 && waistVal > 0 && hipsVal > 0) {
      if (bustVal / hipsVal >= 0.95 && bustVal / hipsVal <= 1.05) {
        if (waistVal / bustVal > 0.75 && waistVal / hipsVal > 0.75) {
          bodyType = "Banana";
          dripBody = "Calculator Banana Result";
          notBody  = ["Calculator Apple Result", "Calculator Hourglass Result", "Calculator Pear Result"];
        } else {
          bodyType = "Hourglass";
          dripBody = "Calculator Hourglass Result";
          notBody  = ["Calculator Apple Result", "Calculator Banana Result", "Calculator Pear Result"];
        }
      } else {
        if (bustVal > hipsVal) {
          bodyType = "Apple";
          dripBody = "Calculator Apple Result";
          notBody  = ["Calculator Banana Result", "Calculator Hourglass Result", "Calculator Pear Result"];
        } else {
          bodyType = "Pear";
          dripBody = "Calculator Pear Result";
          notBody  = ["Calculator Apple Result", "Calculator Banana Result", "Calculator Hourglass Result"];
        }
      }
      MeasureErr.innerHTML = "";
      EmailErr.innerHTML = "";
      console.log(bodyType);
      _dcq.push(["identify", {
        email: InputEmail.value,
        remove_tags: [notBody[0], notBody[1], notBody[2]],
        tags: [dripBody],
        success: function(response) {
          console.log(response);
        }
      }]);
    } else {
      if (!InputBust.validity.valid || !InputWaist.validity.valid || !InputHips.validity.valid) {
        MeasureErr.innerHTML = "<p class='errorText'>Please check your measurements. They should be numbers.</p>";
      }
      if (!InputEmail.validity.valid) {
        EmailErr.innerHTML = "<p class='errorText'>Please enter a valid email.</p>";
      }
      console.log("error with entry");
    }
  }
</script>

</html>
